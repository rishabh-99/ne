<!DOCTYPE html>
<html>
<head>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.1.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.1.0/firebase-database.js"></script>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="./style.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
          /* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  overflow: scroll;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; 
}

/* Modal Content */
.modal-content {
  background-color: #100e17;
  margin: auto;
  padding: 20px;
  box-shadow: rgb(0,0,0);
  width: 80%;
  height: auto;
  color: #ffffff;
  margin-bottom: 10vh;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
        </style>
</head>
<body>
  <div class="container" id="cont">
    <div class="loaderCont">
        <div class="loader"></div>

      </div>
    </div>
  <!-- The Modal -->
<div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
     <div class="disdiv"> <label>First Month:</label></div><input class="inpModal" readonly id="FirstM"></label><br><br>
      <div class="disdiv"><label>Balance:</label></div><input class="inpModal" readonly id="Balance"></input><br><br>
      <div class="disdiv"><label>Cheque:</label></div><input class="inpModal" readonly id="Cheque"></input><br><br>
      <div class="disdiv"><label>Date:</label></div><input class="inpModal" readonly id="Date"></input><br><br>
      <div class="disdiv"><label>EMII:</label></div><input class="inpModal" readonly id="EMII"></input><br><br>
      <div class="disdiv"><label>Last Month:</label></div><input class="inpModal" readonly id="LastM"></input><br><br>
      <div class="disdiv"><label>Name:</label></div><input class="inpModal" readonly id="Name"></input><br><br>
      <div class="disdiv"><label>Term:</label></div><input class="inpModal" readonly id="Term"></input><br><br>
      <div class="disdiv"><label>Total:</label></div><input class="inpModal" readonly id="Total"></input><br><br>
      <div class="disdiv"><label>Due:</label></div><input class="inpModal" readonly id="Due"></input><br><br>
      <div class="disdiv"><label>Loan:</label></div><input class="inpModal" readonly id="Loan"></input><br><br>

<button class="accordion">EMI</button>
<div class="panel">
    <button class="accordion">1st Month</button>
    <div class="panel">
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
    </div>
    
    <button class="accordion">2nd Month</button>
    <div class="panel">
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
    </div>
    
    <button class="accordion">3rd Month</button>
    <div class="panel">
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
    </div>
    
    <button class="accordion">3rd Month</button>
    <div class="panel">
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
    </div>
</div>
    </div>
  
  </div>
  
</body>
<script>
  container=document.getElementsByClassName("container");
  var ab;
var a;
var numberCase;


  function onLoad(){
 
    
        var firebaseConfig = {
        apiKey: "AIzaSyCyGye-WMomVLnTRQ-8wlsXzSUJuJQG1do",
        authDomain: "nefirebase-7624e.firebaseapp.com",
        databaseURL: "https://nefirebase-7624e.firebaseio.com",
        projectId: "nefirebase-7624e",
        storageBucket: "",
        messagingSenderId: "75788997805",
        appId: "1:75788997805:web:cfa574138eef051c352224"
        };
// Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        var database=firebase.database()
        var ref=database.ref("/users")
        ref.on('value',gotData,errData)
        function gotData(response){
        console.log(response)
        ab=response.val();
        a=Object.keys(ab) 

        function getHTML(arr){
          var s=""
          var ds=""
          var ns=""
          var defaulters=new Array()
          var normal=new Array()
          var count=1
          console.log(arr)   
          var month = new Array();
        month[0] = "Jan";
        month[1] = "Feb";
        month[2] = "Mar";
        month[3] = "Apr";
        month[4] = "May";
        month[5] = "Jun";
        month[6] = "Jul";
        month[7] = "Aug";
        month[8] = "Sep";
        month[9] = "Oct";
        month[10] = "Nov";
        month[11] = "Dec";

        var d = new Date();
        var n = month[d.getMonth()];  //AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa
        var y= d.getFullYear().toString().slice(-2)
        var dat=n+"-"+y
        console.log(dat)
          for(var i=0;i<arr.length;i++){
            console.log("a")
            if(ab[arr[i]].EMI[`${dat}`]["moneyRecieved"]=='1'){
              normal.push(`${arr[i]}`)
              
            }
            else{
              defaulters.push(`${arr[i]}`)
            }
            
          }
          console.log(normal)
        console.log(defaulters) 

        for(var k=0;k<defaulters.length;k++){
               
            var elem=` <div class="card" onclick="modaldisplay(${defaulters[k]})">
    <h3 class="title">${defaulters[k]}</h3>
    <div class="bar">
      <div class="emptybar"></div>
      <div class="filledbar2"></div>
    </div>
    <div class="circle">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
      <circle class="stroke" cx="60" cy="60" r="50"/>
    </svg>
    </div>
  </div>`
            ds=ds.concat(elem)
            
          }
          s=s.concat(ds)
          for(var k=0;k<normal.length;k++){
                
            var elem=` <div class="card" onclick="modaldisplay(${normal[k]})">
    <h3 class="title">${normal[k]}</h3>
    <div class="bar">
      <div class="emptybar"></div>
      <div class="filledbar"></div>
    </div>
    <div class="circle">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
      <circle class="stroke2" cx="60" cy="60" r="50"/>
    </svg>
    </div>
  </div>`
            ns=ns.concat(elem)
           
          }
                 s=s.concat(ns)
          return s
        }



        var conten= getHTML(a)
        console.log(conten+"AAAAAAA")

        document.getElementById("cont").innerHTML=conten



        }


        function errData(err){
          console.log(err)
        }


        }
        onLoad()

        //=================================================================================================================================//
        //On load all things finish

        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
          modal.style.display = "none";
          container=document.getElementById("cont")
          container.style.display="flow-root"
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
          if (event.target == modal) {
            modal.style.display = "none";
            container=document.getElementById("cont")
          container.style.display="flow-root"
          }
        }
        function modaldisplay(cno){
          modal.style.display = "block"
          console.log(ab[cno])
          container=document.getElementById("cont")
          container.style.display="none"
          document.getElementById("FirstM").value=ab[cno]["1st Mnth"]
          document.getElementById("Balance").value=ab[cno]["Balance"]
          document.getElementById("Cheque").value=ab[cno]["Cheque"]
          document.getElementById("Date").value=ab[cno]["Date"]
          document.getElementById("EMII").value=ab[cno]["EMII"]
          document.getElementById("LastM").value=ab[cno]["Last Month"]
          document.getElementById("Name").value=ab[cno]["Name"]
          document.getElementById("Term").value=ab[cno]["Term"]
          document.getElementById("Total").value=ab[cno]["Total"]
          document.getElementById("Due").value=ab[cno]["due"]
          document.getElementById("Loan").value=ab[cno]["loan"]
          
        }
        var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}

</script>
</html>