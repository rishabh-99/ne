<!DOCTYPE html>
<html>
<head>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.1.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.1.0/firebase-database.js"></script>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="./style.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <div class="container" id="cont">

  </div>
  
</body>
<script>
  container=document.getElementsByClassName("container");
  var ab;
var a;
var numberCase;
var modal = document.getElementById("myModal");
var span = document.getElementsByClassName("close")[0];
var modal2 = document.getElementById("myModal2");
var span2 = document.getElementsByClassName("close2")[0];

  function onLoad(){
 
    
        var firebaseConfig = {
        apiKey: "AIzaSyCyGye-WMomVLnTRQ-8wlsXzSUJuJQG1do",
        authDomain: "nefirebase-7624e.firebaseapp.com",
        databaseURL: "https://nefirebase-7624e.firebaseio.com",
        projectId: "nefirebase-7624e",
        storageBucket: "",
        messagingSenderId: "75788997805",
        appId: "1:75788997805:web:cfa574138eef051c352224"
        };
// Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        var database=firebase.database()
        var ref=database.ref("/users")
        ref.on('value',gotData,errData)
        function gotData(response){
        console.log(response)
        ab=response.val();
        a=Object.keys(ab) 

        function getHTML(arr){
          var s=""
          var ds=""
          var ns=""
          var defaulters=new Array()
          var normal=new Array()
          var count=1
          console.log(arr)   
          var month = new Array();
        month[0] = "Jan";
        month[1] = "Feb";
        month[2] = "Mar";
        month[3] = "Apr";
        month[4] = "May";
        month[5] = "Jun";
        month[6] = "Jul";
        month[7] = "Aug";
        month[8] = "Sep";
        month[9] = "Oct";
        month[10] = "Nov";
        month[11] = "Dec";

        var d = new Date();
        var n = month[d.getMonth()];  //AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa
        var y= d.getFullYear().toString().slice(-2)
        var dat=n+"-"+y
        console.log(dat)
          for(var i=0;i<arr.length;i++){
            console.log("a")
            if(ab[arr[i]].EMI[`${dat}`]["moneyRecieved"]=='1'){
              normal.push(`${arr[i]}`)
              
            }
            else{
              defaulters.push(`${arr[i]}`)
            }
            
          }
          console.log(normal)
        console.log(defaulters) 

        for(var k=0;k<defaulters.length;k++){
               
            var elem=` <div class="card" data-toggle="modal" data-target="#DangerModalftblack">
    <h3 class="title">${defaulters[k]}</h3>
    <div class="bar">
      <div class="emptybar"></div>
      <div class="filledbar2"></div>
    </div>
    <div class="circle">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
      <circle class="stroke" cx="60" cy="60" r="50"/>
    </svg>
    </div>
  </div>`
            ds=ds.concat(elem)
            
          }
          s=s.concat(ds)
          for(var k=0;k<normal.length;k++){
                
            var elem=` <div class="card" data-toggle="modal" data-target="#DangerModalftblack">
    <h3 class="title">${normal[k]}</h3>
    <div class="bar">
      <div class="emptybar"></div>
      <div class="filledbar"></div>
    </div>
    <div class="circle">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
      <circle class="stroke2" cx="60" cy="60" r="50"/>
    </svg>
    </div>
  </div>`
            ns=ns.concat(elem)
           
          }
                 s=s.concat(ns)
          return s
        }



        var conten= getHTML(a)
        console.log(conten+"AAAAAAA")

        document.getElementById("cont").innerHTML=conten



        }


        function errData(err){
          console.log(err)
        }


        }
        onLoad()
</script>
</html>